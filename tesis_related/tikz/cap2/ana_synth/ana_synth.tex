\documentclass{article}
\usepackage{tikz}
\usepackage{verbatim}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength{\PreviewBorder}{10pt}%
\begin{comment}
\end{comment}
\usetikzlibrary{dsp,chains}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\newcommand{\z}{\mathpzc{z}}

\begin{document}
\begin{tikzpicture}
				\draw[step=0.5,very thin,black!20] (-8,-6) grid (8,6);
				%\draw[help lines] (-6,-8) grid (6,2);
	% Place nodes using a matrix
	\matrix (m1) [row sep=2.5mm, column sep=10mm]
	{
		%------------------------------------------------------------
    \node[coordinate]           (m01) {};          &
    \node[dsp/label=above]      (m02) {$W_K^{-0}$};    &
    \node[coordinate]           (m03) {};          &
    \node[coordinate]           (m04) {};          &
    \node[coordinate]           (m05) {};          &
    \node[coordinate]           (m06) {};          &
    \node[coordinate]           (m07) {};          &
    \node[coordinate]           (m08) {};          &
    \node[dsp/label=above]      (m09) {$W_K^{-0}$};    &
    \node[coordinate]           (m010) {};          \\
		%Fila 1------------------------------------------------------
    \node[coordinate]            (m11) {};          &
    \node[dspmixer]              (m12) {};          &
    \node[dspsquare]             (m13) {$h(n)$};    &
    \node[dspsquare]             (m14) {\downsamplertext{M}}; &
		\node[dsp/label=north]       (m15) {$X_0(m)$};          &
				\node[dsp/label=north]       (m16) {$\hat{X}_0(m)$};          &
    \node[dspsquare]             (m17) {\upsamplertext{M}}; &
    \node[dspsquare]             (m18) {$f(n)$};    &
    \node[dspmixer]              (m19) {};          &
    \node[coordinate]            (m110) {};          \\
%   \node[coordinate]            (m09) {};          &
%    \node[dspnodeopen,dsp/label=above] (m09) {$y_k[m]$};  \\
		%Fila 2-------------------------------------------------------
%    \node[coordinate]            (m11) {};          &
%    \node[dspmixer]              (m12) {};          &
%    \node[dspsquare]             (m13) {$h[n]$};    &
%    \node[dspsquare]             (m14) {\downsamplertext{M}}; &
%		\node[coordinate]            (m15) {};          &
%		\node[coordinate]            (m16) {};          &
%    \node[dspsquare]             (m17) {\upsamplertext{M}}; &
%    \node[dspsquare]             (m18) {$f[n]$};    &
%    \node[dspmixer]              (m19) {};          &
%    \node[coordinate]            (m1a) {};          \\
%%   \node[coordinate]            (m18) {};          &
%%    \node[dspnodeopen,dsp/label=above] (m19) {$y_k[m]$};  \\
%		%Fila 3------------------------------------------------------
%    \node[coordinate]            (m21) {};          &
%    \node[dspmixer]              (m22) {};          &
%    \node[dspsquare]             (m23) {$h[n]$};    &
%    \node[dspsquare]             (m24) {\downsamplertext{M}}; &
%		\node[coordinate]            (m25) {};          &
%		\node[coordinate]            (m26) {};          &
%    \node[dspsquare]             (m27) {\upsamplertext{M}}; &
%    \node[dspsquare]             (m28) {$f[n]$};    &
%    \node[dspmixer]              (m29) {};          &
%    \node[coordinate]            (m2a) {};          \\
%%   \node[coordinate]            (m28) {};          &
%%    \node[dspnodeopen,dsp/label=above] (m29) {$y_k[m]$};  \\
%		%Fila 4------------------------------------------------------
%    \node[coordinate]            (m31) {};          &
%    \node[dspmixer]              (m32) {};          &
%    \node[dspsquare]             (m33) {$h[n]$};    &
%    \node[dspsquare]             (m34) {\downsamplertext{M}}; &
%		\node[coordinate]            (m35) {};          &
%		\node[coordinate]            (m36) {};          &
%    \node[dspsquare]             (m37) {\upsamplertext{M}}; &
%    \node[dspsquare]             (m38) {$f[n]$};    &
%    \node[dspmixer]              (m39) {};          &
%    \node[coordinate]            (m3a) {};          \\
%%   \node[coordinate]            (m38) {};          &
%%    \node[dspnodeopen,dsp/label=above] (m39) {$y_k[m]$};  \\
		%------------------------------------------------------------
%		\node[coordinate]                  (m10) {};          &
%		\node[coordinate]                  (m11) {};          &
%		\node[dspmixer, dsp/label=right]   (m12) {$h[0]$};    &
%		\node[coordinate]                  (m13) {};          &
%		\node[dspmixer, dsp/label=right]   (m14) {$h[1]$};    &
%		\node[coordinate]                  (m15) {};          &
%		\node[dspmixer, dsp/label=right]   (m16) {$h[2]$};    &
%		\node[coordinate]                  (m17) {};          &
%		\node[dspmixer, dsp/label=right]   (m18) {$h[3]$};    &
%		\node[coordinate]                  (m19) {};          &
%		\node[coordinate]                  (m1X) {};          \\
		%------------------------------------------------------------
		%\\
		%------------------------------------------------------------
%		\node[coordinate]                  (m20) {};          &
%		\node[coordinate]                  (m21) {};          &
%		\node[coordinate]                  (m22) {};          &
%		\node[coordinate]                  (m23) {};          &
%		\node[dspadder]                    (m24) {};          &
%		\node[coordinate]                  (m25) {};          &
%		\node[dspadder]                    (m26) {};          &
%		\node[coordinate]                  (m27) {};          &
%		\node[dspadder]                    (m28) {};          &
%		\node[coordinate]                  (m29) {};          &
%		\node[dspnodeopen,dsp/label=above] (m2X) {$y[n]$};    \\
%		%-----------------------------------------------------------
	};

	% Draw connections
	
	\begin{scope}[start chain]
		\chainin (m02);
		\chainin (m12) [join=by dspconn];
		\chainin (m09);
		\chainin (m19) [join=by dspconn];
		%\chainin (m12) [join=by dspconn];
		%\chainin (m22) [join=by dspline];
	\end{scope}

	\foreach \i [evaluate = \i as \j using int(\i+1),
	             evaluate = \i as \k using int(\i+2),] in {1,2,3,6,7,8}
	{
		\begin{scope}[start chain]
%			\chainin (m0\i);
%			\chainin (m0\j) [join=by dspconn];
%			\chainin (m0\k) [join=by dspconn];
			\chainin (m1\i);
			\chainin (m1\j) [join=by dspconn];
			\chainin (m1\k) [join=by dspconn];
%			\chainin (m2\i);
%			\chainin (m2\j) [join=by dspconn];
%			\chainin (m2\k) [join=by dspconn];
%			\chainin (m3\i);
%			\chainin (m3\j) [join=by dspconn];
%			\chainin (m3\k) [join=by dspconn];
			%\chainin (m1\k) [join=by dspconn];
			%\chainin (m2\k) [join=by dspconn];
		\end{scope}
		%\draw[dspconn] (m2\i) -- (m2\k);
	}

%	\draw[dspflow] (m28) -- (m2X);
%
%	% Draw connections
%
%	\draw[dspflow] (m00) -- (m01);
%	
%	\foreach \i [evaluate = \i as \j using int(\i+1)] in {1,2,3}
%		\draw[dspflow] (m0\i) -- node[midway,above] {$\z^{-1}$} (m0\j);
%
%	\foreach \i [evaluate = \i as \j using int(\i-1)] in {1,2,...,4}
%		\draw[dspflow] (m0\i) -- node[midway,right] {$h[\j]$} (m1\i);
%		
%	\foreach \i [evaluate = \i as \j using int(\i+1)] in {1,2,...,4}
%		\draw[dspflow] (m1\i) -- (m1\j);
	
	% Other elements
%	\node[dspsquare, below=of m10, below=10ex]       (c0) {\upsamplertext{L}};
%	\node[dspsquare,right= of c0]                    (c1) {\downsamplertext{M}};
%	\node[dspfilter,right=of c1]                     (c2) {$H(\z)$};
%	\node[dspmultiplier,right=of c2,dsp/label=below] (c3) {$\gamma$};
%	\node[dspfilter,right=of c3,minimum size=2cm,text height=2em]
%	                                                 (c4) {Weird\\ Stuff};
%	\foreach \i [evaluate = \i as \j using int(\i+1)] in {0,1,...,3}
%		\draw[dspconn] (c\i) -- (c\j);
\end{tikzpicture}

\end{document}
