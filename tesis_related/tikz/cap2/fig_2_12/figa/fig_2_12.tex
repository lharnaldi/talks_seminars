\documentclass{article}
\usepackage{tikz}
\usepackage{verbatim}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength{\PreviewBorder}{15pt}%
\begin{comment}
\end{comment}
\usetikzlibrary{dsp,chains}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\newcommand{\z}{\mathpzc{z}}

\begin{document}
\begin{tikzpicture}

				%\draw[help lines,step=0.5] (-5,-2) grid (5,2);
	% Place nodes using a matrix
	\matrix (m1) [row sep=3mm, column sep=5mm]
	{
		%first row
		%------------------------------------------------------------
		\node[coordinate]                  (m000) {};    &
		\node[coordinate]                  (m001) {};          &
		\node[dspnodeopen]                  (m002) {};          &
		\node[dspsquare,minimum width=1.6cm](m003) {$\bar{p}_0(m)$}; &
		\node[coordinate]                  (m004) {};    &
		\node[coordinate]                  (m005) {};          &
		\node[coordinate]                  (m006) {};          &
		\node[coordinate]                  (m007) {};          &
		\node[coordinate]                  (m008) {};          &
%		\node[coordinate]                  (m009) {};          &
%		\node[coordinate]                  (m010) {};&
%		\node[dspsquare,minimum width=1.6cm](m011) {$\bar{p}_0(m)$}; &
%		\node[coordinate]                  (m012) {};          &
%		\node[coordinate]                  (m013) {};          &
		\node[coordinate]                  (m009) {};          \\
%		\node[dspnodeopen,dsp/label=above] (m09) {$y_\rho(m)$};  \\
		%------------------------------------------------------------
		%second row
		%------------------------------------------------------------
		\node[coordinate]                  (m100) {};    &
		\node[coordinate]                  (m101) {};          &
		\node[dspnodeopen]                  (m102) {};          &
		\node[dspsquare,minimum width=1.6cm](m103) {$\bar{p}_1(m)$}; &
		\node[coordinate]                  (m104) {};    &
		\node[coordinate]                  (m105) {};          &
		\node[coordinate]                  (m106) {};          &
		\node[coordinate]                  (m107) {};          &
		\node[coordinate]                  (m108) {};          &
%		\node[coordinate]                  (m109) {};          &
%		\node[coordinate]                  (m110) {};&
%		\node[dspsquare,minimum width=1.6cm](m111) {$\bar{p}_1(m)$}; &
%		\node[coordinate]                  (m112) {};          &
%		\node[coordinate]                  (m113) {};          &
		\node[coordinate]                  (m109) {};          \\ \\
%		%------------------------------------------------------------
		%third row
		%------------------------------------------------------------
		\node[dspnodeopen,dsp/label=above] (m200) {$x(n)$};    &
		\node[coordinate]                  (m201) {};          &
		\node[dspnodeopen]                 (m202) {};          &
		\node[dspsquare,minimum width=1.6cm](m203) {$\bar{p}_\rho(m)$}; &
		\node[coordinate]                  (m204) {};    &
		\node[coordinate]                  (m205) {};          &
		\node[coordinate]                  (m206) {};          &
		\node[dspadder]                  (m207) {};          &
		\node[coordinate]                  (m208) {};          &
%		\node[coordinate]                  (m209) {};          &
%		\node[coordinate]                   (m210) {};&
%		\node[dspsquare,minimum width=1.6cm](m211) {$\bar{p}_\rho(m)$}; &
%		\node[coordinate]                  (m212) {};          &
%		\node[coordinate]                  (m213) {};          &
		\node[coordinate]                  (m209) {};          \\ \\
		%------------------------------------------------------------
		%fourth row
		%------------------------------------------------------------
		\node[coordinate]                  (m300) {$x_\rho(r)$};    &
		\node[coordinate]                  (m301) {};          &
		\node[dspnodeopen]                  (m302) {};          &
		\node[dspsquare,minimum width=1.6cm](m303) {$\bar{p}_{M-1}(m)$}; &
		\node[coordinate]                  (m304) {};    &
		\node[coordinate]                  (m305) {};          &
		\node[coordinate]                  (m306) {};          &
		\node[coordinate]                  (m307) {};          &
		\node[coordinate]                  (m308) {};          &
%		\node[coordinate]                  (m309) {};          &
%		\node[coordinate]                  (m310) {};&
%		\node[dspsquare,minimum width=1.6cm](m311) {$\bar{p}_{M-1}(m)$}; &
%		\node[coordinate]                  (m312) {};          &
%		\node[coordinate]                  (m313) {};          &
		\node[coordinate]                  (m309) {};          \\
		%--------------------------------------------------------------------
	};

	% Draw connections
	\foreach \i [evaluate= \i as \j using int(\i+2),
	             evaluate= \i as \k using int(\i+3)] in {0,1,2,3}
	{
		\begin{scope}[start chain]
			\chainin (m\i02);
			\chainin (m\i03) [join=by dspconn];
			\chainin (m\i03);
			\chainin (m\i06) [join=by dspline];
%			\chainin (m\i10);
%			\chainin (m\i11) [join=by dspline];
%			\chainin (m\i11);
%			\chainin (m\i12) [join=by dspconn];
%			\chainin (m10\j);
%			\chainin (m10\k) [join=by dspconn];
%			\chainin (m20\j);
%			\chainin (m20\k) [join=by dspconn];
%			\chainin (m30\j);
%			\chainin (m30\k) [join=by dspconn];
%			\chainin (m00\k) [join=by dspline];
%			\chainin (m10\k) [join=by dspconn];
%			\chainin (m20\k) [join=by dspconn];
		\end{scope}
%		\draw[dspconn] (m20\i) -- (m20\k);
	}
	
%	\begin{scope}[start chain]
%		\chainin (m002);
%		\chainin (m003) [join=by dspflow];
%		\chainin (m102);
%		\chainin (m103) [join=by dspflow];
%		\chainin (m202);
%		\chainin (m203) [join=by dspflow];
%		\chainin (m302);
%		\chainin (m303) [join=by dspflow];
%	\end{scope}

%	\foreach \i [evaluate = \i as \j using int(\i+1),
%	             evaluate = \i as \k using int(\i+2),] in {2,4,6}
%	{
%		\begin{scope}[start chain]
%			\chainin (m00\i);
%			\chainin (m00\j) [join=by dspconn];
%			\chainin (m00\k) [join=by dspline];
%			\chainin (m10\k) [join=by dspconn];
%			\chainin (m20\k) [join=by dspconn];
%		\end{scope}
%		\draw[dspconn] (m20\i) -- (m20\k);
%	}

	\draw[dspconn] (m200) -- (m201);
	\draw[dspconn] (m201) |- (m002);
	\draw[dspconn] (m201) |- (m002);

	\draw[dspconn] (m006) -- (m207);
	\draw[dspconn] (m106) -- (m207);
	\draw[dspconn] (m206) -- (m207);
	\draw[dspconn] (m306) -- (m207);

	\draw[dspconn] (m207) -- (m209);


%	\node at(-6,0)[dspnodeopen,dsp/label=above](in01){$x(n)$};
%	\node at(-5,0)[coordinate](in02){};
%	\draw[dspconn] (in02) |- (m002);
%	\node at(0,0)[dspadder] (ad01) {};
%	\draw[dspconn] (ad01) -- (1,0);
	\node at(3,-0.55)[above](out01){$X_k(m)$};
	\node at(m005)[above,scale=1](o01){$W_M^0$};
	\node at(m105)[above,scale=1](o01){$W_M^{k}$};
	\node at(m205)[above,scale=1](o01){$W_M^{k\rho}$};
	\node at(m305)[above,scale=1](o01){$W_M^{k(M-1)}$};
%	\draw[dspconn] (m005) -- (ad01);
%	\draw[dspconn] (m105) -- (ad01);
%	\draw[dspconn] (m205) -- (ad01);
%	\draw[dspconn] (m305) -- (ad01);
%	\node at(5.5,0)[dspsquare,minimum height=5.2cm,minimum width=1.6cm] {};
	\node at(-1,0.3) [] {$\vdots$};
	\node at(-1,-1.2) [] {$\vdots$};
	\draw[dspconn] (-2.6,2.4) -- (-2.6,1.4);
	\node at (0,-3)[]{\textbf{a)}};

	\
\end{tikzpicture}

\end{document}
